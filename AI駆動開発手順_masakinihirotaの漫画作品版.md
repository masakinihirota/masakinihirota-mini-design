# Webアプリの規模

Webアプリを分類すると
シンプル 1つだけの機能
小規模 2,3個の機能がある、DBを使う
中規模 複数の機能やユーザー管理などがあり、本格的なアプリ。
大規模 1000-1万人ぐらいを使うことを想定したWebアプリ

この設計書は中規模のWebアプリです。


# AI駆動開発手順_masakinihirota-miniの漫画作品版
※これはmasakinihirota-vnsの基本的な機能のみの実装です。
## 構想、概要
## 要件定義
## 仕様書
## 設計書
## 実装手順
を書きます。

--- 構想、概要
**価値観で繋がる新しい形のネットワークサービス**であり、ここでは特に**漫画作品**を通じた繋がりを作ります。

従来のSNSが社会的な繋がりを重視するのに対し、masakinihirota-mini（漫画作品版）は**好きな漫画作品という価値観**でユーザー同士が繋がり、交流できる場所を提供することを構想します。**個人の尊重**を重視し、安心・安全なコミュニケーションが可能なコミュニティを目指します。

--- 要件定義
1.  **ユーザー登録・ログイン:** ユーザーがアカウントを作成し、ログインできる機能。
2.  **ユーザープロフィール作成:** 好きな漫画作品に関する情報を登録できるユーザープロフィールを作成できる機能。
3.  **漫画作品登録:** ユーザーが好きな漫画作品を登録できる機能。
4.  **作品リスト表示:** 登録された漫画作品を一覧表示できる機能。
5.  **自動マッチング:** ユーザーの登録した漫画作品に基づいて、価値観の近いユーザーを自動的にマッチングする機能。
6.  **グループ機能:** 同じ価値観を持つユーザー同士がグループを形成できる基本的な機能。

--- 仕様書
1.  **ユーザー登録・ログイン:**
    *   OAuth認証を利用します。
    *   アカウント作成時にいくつかの質問（好きな漫画のジャンルなど）をできるようにします。
2.  **ユーザープロフィール作成:**
    *   ニックネーム、使用言語などの基本情報に加え、好きな漫画作品（今、未来、人生で読みたい・読んだ作品）を登録できる項目を設けます。
    *   他のユーザーから見たプロフィールを作成する機能は省略します。
3.  **漫画作品登録:**
    *   作品名、作者名などの基本情報を登録できます。
    *   ユーザー登録作品として扱います。
    *   評判の良い作品は将来的に公式リストに登録される可能性があります。
4.  **作品リスト表示:**
    *   登録された漫画作品を一覧で表示します。
    *   キーワード検索などの絞り込み機能は含めません。
5.  **自動マッチング:**
    *   ユーザーが登録した好きな漫画作品のリストを比較し、共通の作品が多いユーザーをマッチング候補として提示します。
    *   「自分が褒めてない作品を褒めている人はマイナス効果」といった複雑なアルゴリズムは含めません。
6.  **グループ機能:**
    *   ユーザーは興味のある漫画作品に関するグループを自動的または手動で作成できます。
    *   グループにはリーダー（作成者）とメンバーが存在します。
    *   グループ内でのコミュニケーション機能は本バージョンでは含めません。

--- 設計書

# masakinihirota
	漫画作品

## 名前の由来
インターネットという情報の洪水の中から**まっさきに価値ある情報（ここでは漫画作品）を拾い上げる**サービス。

## キャッチフレーズ
「昨日僕が感動した漫画を、今日の君はまだ知らない。」

## サイト
まだ未定です。

## コンセプト
**名前などの属性情報を伏せて、好きな漫画作品という価値観のみで合うかどうかを判断**し、合いそうな人同士で繋がる場所。**人間ではなく価値観をマッチング**させます。好きな漫画作品リストを共有し、同じ趣味を持つ人たちが友人になるきっかけを作るサイトです。

## ユーザープロフィールの項目
*   基本情報：名前（個別識別できる名前）、使用言語
*   好きなもの：
    *   今読んでいる好きな作品
    *   未来読みたい作品
    *   人生で好きな作品（読了済みの評価が確定した作品）

## オープンソース、オープンデーター
基本的な情報はすべて公開されます。信用してもらうにはこれが一番早く正確であり、誰もが検証できることを目指します。

# ランディングページ
masakinihirota（漫画作品版）の説明、サイトの趣旨がわかるように記述します。

# アカウント作成 ログイン画面
OAuth認証を使用します。アカウント作成時に好きな漫画のジャンルなどの質問を設けることを検討します。

# メニュー
基本的なナビゲーションメニューを設置します。





# ルートアカウント
## ユーザー基本情報
ユーザーを識別するID、アカウント情報などを管理します。

## ユーザープロフィールの管理
ユーザーが作成したプロフィール情報を管理します。

## 信頼度
初期バージョンでは、GitHubアカウントやGoogle認証の有無などの基本的なチェック項目のみを考慮します。

## ユーザープロフィールの状態をまとめて管理
ユーザープロフィールの最新の状態（例：現在、積極的に漫画仲間を探しているかなど）を管理する機能は、必要最低限の形で実装を検討します。

## 自分のグループの価値観ルール
グループ内でどのような行為を禁止するかをリーダーが設定できる機能は、初期バージョンでは基本的なネガティブな発言の禁止程度とします。





# ユーザープロフィール
## 新規ユーザープロフィール
### ユーザープロフィール作成の目的
趣味（漫画仲間探し）を主な目的とします。

## 基本ユーザープロフィール
好きな漫画作品に関する情報を登録するプロフィール。
### 最新の状態
現在、積極的に漫画について語り合える仲間を探しているかなどの状態を設定できるようにします。

### ユーザーの基本情報
名前（ニックネーム）、使用言語。

### ユーザーが作った作品
自身で制作した漫画作品などを登録できる項目を設けます。

### ユーザーがアウトプットしている場所とそのアカウント
自身のブログやSNSアカウントなど、漫画に関するアウトプットを行っている場所の情報を登録できるようにします。

### 好きな作品の時制
#### 今、未来、人生情報
それぞれの時制で好きな漫画作品を登録します。

#### 今の価値観情報
現在読んでいる漫画、連載中の作品などを登録します。ネタバレ禁止の注意喚起を行います。

#### 未来の価値観情報
これから読みたい漫画、購入予定の漫画などを登録します。

#### 人生の価値観情報
読了済みで評価が確定した、人生で特に好きな漫画作品を登録します。これらの作品についてはネタバレありの会話が可能となることを示唆します。

### ティア評価

登録済みの作品のリストの中から選んで、ユーザープロフィールに登録します。
その時同時に評価も出来ます。

評価の方法はティア評価で、絶対相対評価を採用します。

#### 絶対相対評価とは？

絶対評価をした作品を最初に選びます。
2番目以降の評価する作品はすべて相対評価で行います。

絶対評価について: 一番面白い作品をティア1に登録します。
相対評価について: 絶対評価した作品と同じぐらい好きならティア1、もしくはひとつ下のティア2に登録します。


そして次から評価する作品は絶対評価した作品とは相対的に評価していきます。

絶対評価した作品は一番好きなのでそれ以上の評価にはなりません。
相対評価した作品は、絶対評価した作品と同じぐらい好きティア1か、もしくはひとつ下のティア2にいれる評価となります。
作品を追加していく時にこれを繰り返していきます。

それぞれのティアには複数の作品を登録可能です。

ティアには面白い作品と評価した物を登録します。
普通かそれ以下の場合は
普通もしくは自分には合わなかった作品として登録します。
まだ読んでいる途中などで評価が未確定の作品は
未評価の作品として登録します。

##### 絶対相対評価の例

ティア1
	進撃の巨人(*一番好き)
	沈黙の艦隊
	龍と苺

ティア2
	MAJOR
	数字であそぼ
	その着せ替え人形は恋をする

ティア3
	MOONLIGHT MILE
	弱虫ペダル

普通もしくは自分には合わなかった作品
	かげきしょうじょ
	私たちはどうかしている
	2.5次元の誘惑
	異世界おじさん

未評価の作品
	シャングリラフロンティア
	神様のバレー
	ラーメン赤猫
	ダイヤモンドの功罪




# 作品関連
## 作品リスト
登録されている漫画作品を一覧表示します。

## 作品登録
ユーザーが好きな漫画作品を登録できます。





# マッチング機能

## 自動マッチング
ユーザーの登録した好きな漫画作品に基づいて、共通点が多いユーザーを自動的にマッチングします。

マッチングの方法
相手とのユーザープロフィールに登録している作品数を比較し、共通点の多いユーザー同士をマッチングします。

### マッチングの基準
マッチングは、作品数だけでなく、評価の高い作品やジャンルの好みも考慮します。


## 手動マッチング
ランダムに他のユーザーのプロフィールを表示するなどの機能は、初期バージョンでは検討しません。

## マッチング後の価値観比較機能
マッチングしたユーザー同士で、登録している好きな漫画作品を比較できる画面を表示します。





# グループ機能
## リーダー
グループを作成したユーザーがリーダーとなります。メンバーの管理などを行います。

## メンバー
グループに参加したユーザーです。

## 自動グループ機能
共通の好きな漫画作品を持つユーザー同士が自動的にグループを作成する機能を検討します。

## 手動グループ機能
ユーザーが任意にグループを作成したり、他のユーザーを招待してグループを形成したりできる機能を検討します。





# 管理画面
初期バージョンでは、基本的なユーザー管理機能のみを備えたシンプルな管理画面を想定します。

# その他
特にありません。


# 画面遷移図




---実装手順

# 実装の考え方

1. 設計書の徹底的な理解
2. 実装する小さな機能の選定と優先順位付け
3. 技術スタックの準備と開発環境の構築

4. データベース設計
5. 選定した小さな機能の実装
6. テストの実装と実行
7. バージョン管理と継続的インテグレーション (CI)
8. デプロイとフィードバック
9. 反復と改善(4．まで戻って繰り返します。)

重要なのは、各機能が独立しているだけでなく、最終的にはシステム全体として整合性を持つように設計することです。

そのため、初期段階からシステム全体のアーキテクチャをある程度見据えておくことが重要になります。


# スターター

👇 土台となるスターターがあります。

nextjs/saas-starter: Get started quickly with Next.js, Postgres, Stripe, and shadcn/ui.
https://github.com/nextjs/saas-starter

README.mdには以下のように記載されています。

```
# Getting Started
git clone https://github.com/nextjs/saas-starter
cd saas-starter
pnpm install

# Running Locally
# Use the included setup script to create your .env file:

pnpm db:setup

```

スターターを利用して、ユーザー登録・ログイン、ユーザープロフィール作成（好きな漫画登録含む）、漫画作品登録、作品リスト表示、自動マッチング、基本的なグループ機能の実装を優先的に行います。

スターターをuithub化し、NotebookLMに読み込ませる手順は、必要に応じて実施します。

※uithubとうサービスがあります。



# 機能
masakinihirotaの漫画作品の登録と
ユーザープロフィールを作る

# 採用技術
## フロントエンド
*   **Next.js** : Reactベースのフレームワーク。
*   **React** : ユーザーインターフェース構築。
*   **Shadcn/UI** : UIコンポーネントライブラリ。
*   **Radix UI** : アクセシブルなUIコンポーネント。
*   **Tailwind CSS** : CSSフレームワーク。

## バックエンド
*   **Node.js** : JavaScriptランタイム。
*   **Supabase** : オープンソースFirebase代替（データベース、認証）。
*   **Drizzle ORM** : 型安全なORM。
*   **Hono** : 高速なWebフレームワーク（APIサーバー）。

## 状態管理
*   **Zustand** : 軽量な状態管理ライブラリ。

## テスト
*   **Vitest** : 高速なユニットテストフレームワーク。
*   **Jest** : テストフレームワーク。

## バリデーション
*   **Zod** : 型安全なスキーマバリデーションライブラリ。

## 支払い処理
*   初期バージョンでは実装しません。

## その他
*   **Vercel** : ホスティングプラットフォーム。
*   **GitHub** : ソースコード管理。

# 開発環境
Windows 10
Visual Studio Code
PowerShell
Git
Docker
Node.js

SupabaseはローカルのDockerを立ち上げSupabaseのコンテナを利用します。
ローカルのSupabaseで開発して、運用時にサーバーのSupabaseに切り替えます。

APIはHonoを使用します。

ルーティングは
Next.jsのApp routerを使用します。



# 実装ルール

一貫性のある命名規則

機能を追加した後でテストを書きます。
    ユニットテスト
    E2Eテスト

コードにコメントを書きます。

ドキュメントの作成
    ドキュメントは最新の状態を保ちます。



# 具体的な実装

タスク分解をします。
優先する機能順に実装していきます。

* 作品登録機能
DBに漫画を登録していきます。
ブラウザ画面から漫画作品を登録できます。

* 登録作品のリスト表示
DBに保存された漫画のリストを表示します。

* ルートアカウントの作成
ログインしたユーザーを管理します。
この機能はスターターでログインしたユーザーを利用して
Supabaseのpublicにルートアカウントテーブルを作って管理します。

* ユーザープロフィールの作成
ログインしたユーザーは複数のユーザープロフィールを作成できます。

ユーザープロフィールは
仕事用
友人用
遊び用
婚活用
終活用
などの目的を選んで作ります。

* ユーザープロフィールに作品を追加
登録した漫画作品の中から選んでユーザープロフィールに登録します。

* マッチング機能
ユーザープロフィール同士を比べて
価値観が近い人を探します。

* グループ機能
マッチングで似た価値観を見つけたらグループに入れます。
グループのリーダーは自分が自動でなります。
マッチングで見つけた人はメンバーになります。

メンバーの状態はウォッチです。

ウォッチとはただ相手を見ているだけの状態です。
相手に見ていることを知らせたい場合は
フォローという状態に更新します。

グループ内の状態
ウォッチ
フォロー
の2種類があります。



---Clineの使用方法

# Cline

## Clineのインストール

1. VSCodeの拡張機能からClineをインストールします。

## Clineの設定

1. Clineを起動し、Planモードを選択します。
2. Clineの設定を行います。
    - Clineのチャット欄の下にあるAuto-approveを開き、それぞれのオプションを設定します。

### Read files and directories
ファイルを読むことを許可します。

### Edit files
これ許可しないとファイルを生成せず、作ってとお願いしたことがClineの中だけで作ったことになります。

### Execute safe commands
危険なコマンド以外実行することを許可します。

### Use the browser
ブラウザを使うことを許可します。

### Use MCP servers
簡単に言うと、外部(ネット上)の情報にClineがアクセスするための許可です。



## 設計書と実装手順の準備

0. Gitでリポジトリを作成し、設計書と実装手順をMarkdownファイルで用意します。
gitでバージョン管理をしておけばいつでも戻ることが出来ます。

```terminal
git init

```

1. Webアプリの設計書を読み込みます。
    - 設計書の内容を確認します。
    - Markdownファイルに設計書を書きます。
2. 同じMarkdownファイルに実装手順を書きます。

## Clineへの読み込み

1. 設計書と実装手順を書いたファイルをClineに読み込ませます。
    - コピペするか、ファイル名で指示します。

## Planモードでの確認

1. ClineのPlanモードで設計書の内容を確認し、実装手順を確認します。
2. 画面遷移図を作成します。
3. エラーハンドリングのフローを確認します。
4. 必要に応じて設計書に修正を加えます。
5. 修正後、再度ClineのPlanモードで内容を確認します。

## Actモードでの実装

Actモードに入る前に、gitでバージョン管理をしておけばいつでも戻ることが出来ます。

1. 設計書の内容に満足したら、ClineのActモードで実装を開始します。
2. 実装が完了したら、テストを行います。
3. テスト後、必要に応じて修正を加えます。
4. 修正後、再度テストを実施し、最終チェックを行います。

現実のコードとCline上の認識が一致しているかを考えてもらう。
「*****はまだ出来ていません。もういちどソースコードを見直してみてください。」

### Tips

- Clineの設定は慎重に行い、必要なオプションを適切に設定しましょう。
- Markdownファイルに設計書と実装手順をまとめておくと、後で見返す際に便利です。
- Planモードでしっかりと確認を行い、実装に移る前に不明点を解消しておきましょう。
- テスト結果をドキュメントに記録し、次回の参考にしましょう。

Planモードで設計書と実装手順を何度も編集します。
「もう一度設計書を評価してみてください。」
「改善提案: 不明点、曖昧な部分、修正したほうがいい箇所などがありましたら教えてください。」

とClineに伝えて、何度でも満足行くまで設計書を検討します。



